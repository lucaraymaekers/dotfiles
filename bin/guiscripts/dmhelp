#!/usr/bin/env sh
program="${1:-$(dmenu_path | dmenu -l 4 -g 5)}"
opfil="/tmp/dmh_options.txt"
test -z "${program}" && exit 1

if ${program} --help > "${opfil}"
then
    option="$(\
        grep -E "^ *-[-a-Z]* " "${opfil}" \
            | tr -s ' ' \
            | sort | uniq \
            | column -l 2 -t \
            | dmenu -x -l 20 -g 1 -p "${program}" \
            | awk '{print $1}' \
    )"
elif man $program > "${opfil}"
then
    echo lesgo
else
    echo "No options found for '${program}'" > /dev/stderr
    exit 1
fi
test -z "${option}" && exit 1

rm -f "${opfil}"
${program} ${option}
