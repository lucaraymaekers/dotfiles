#!/bin/sh
if [ "$(id -u)" -ne 0 ]
then
	>&2 printf "Not root.\n"
	exit 1
fi

printf 'name? '
name="$(head -n 1)"
printf 'password? '
password="$(head -n 1)"
printf 'database? '
database="$(head -n 1)"

(
    cat <<EOF
    CREATE USER '$name'@'%' IDENTIFIED BY '$password';
EOF
    [ "$database" ] && cat <<EOF
    GRANT ALL PRIVILEGES ON `$database`.* TO '$name'@'%' WITH GRANT OPTION;
    CREATE DATABASE `$database`;
    FLUSH PRIVILEGES;
EOF

) | mariadb
