#!/bin/sh

# Translate words using http://context.reverso.net and scraping the answers

for dependency in pup curl fzf
do
	if ! command -v "$dependency" > /dev/null
	then
		>&2 printf '"%s" (dependency) could not be found.\n' "$dependency"
		exit 1
	fi
done

# returns available languages
languages () {
	printf 'arabic\nchinese\nczech\ndanish\ndutch\nenglish\nfrench\ngerman\ngreek\nhebrew\nhindi\nhungarian\nitalian\njapanese\nkorean\npersian\npolish\nportuguese\nromanian\nslovak\nspanish\nswedish\nthai\nturkish\nukrainian\n'
}

if [ -z "${word:=$1}" ]
then
    >&2 printf '>'
    word="$(head -n1)"
fi
[ "$word" ] || exit 1

primary="$(languages | fzf --prompt="from:")"
[ "$primary" ] || exit 1

secondary="$(languages | fzf --prompt="to:")"
[ "$secondary" ] || exit 1

tgpt "Please, can you translate the following from $primary to $secondary, your answer should contain the translation and only the translation do not explain the answer, keep it to the translated words, if multiple are possible give them all.: $word"
